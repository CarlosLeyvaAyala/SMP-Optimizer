## Analyze

You can analyze files by dropping your files/folders to `analyze.bat` instead of `optimize - x.bat`.

!!! 
    SMP Optimizer always analyzes files before optimizing them, but running `analyze.bat` will not optimize them.

#### What is this used for?

Because <span class="important">I need your help</span>

You see, this program works by changing the way bodies collide with clothes so this collision uses a less expensive algorithm than the one that ususally comes configured by default in armors.

It first finds which is(are) the bodie(s), then it changes its(their) configuration according to your settings.
Whatever is not a body, is considered an armor.

The problem here is: <span class="important">there's no consensus on how bodies should be named</span>.
Each modder is free to name their bodies and armors however they want.

Although many modders name their bodies `"VirtualBody"`, `"VirtualHands"`, `"VirtualSomething"`... there's nothing preventing them using whatever they want.

Why is that a problem? Well, when they name them in some unknown way to this program, everything is considered an armor and **you may get unexpected results when using medium optimization levels**[^Unexpected].

[^Unexpected]: Don't worry. Your computer won't explode, nor your armor will be ruined.
What will actually happen is that the program would optimize too aggresive or not at all; and that's definitely what you DON'T want if you're using a medium optimization level.

Analyzing files will report when an SMP xml configuration file has no known bodies and it tells you which possible bodies it has, so you can report them to me.

### How to report results

This is where I need your help, since it involves a bit of work and there's simply no way I can check all existing SMP armors myself.

Don't worry, **the process is quite fast and easy**; but it's simply too much work for me to do alone.

I'll start by using some examples from my own mods when I was developing this program, from  easiest to hardest.
The output is from my own development version **`SMP Optimizer 1.2`**, so the way this info is presented to you may differ, but it should be quite recognizable anyway.

Analysis output:

```
x:\bla bla bla...\meshes\Evil Lady\evldy.xml
collisionBody
EL_Hands_Cloth

x:\bla bla bla...\meshes\Princess\Skirt.xml
CollisionBody
Boots
SkirtA_1_1

x:\bla bla bla...\meshes\Dragon Lilly\skirt.xml
boxlow
skirt

x:\bla bla bla...\meshes\BDO Darkborne Rose\BDORdrArmor.xml
VCBBE
00BDORdrArmorUB
00BDORdrArmorDecShoHDT
00BDORdrArmorDecShoHDT001
Scene Root:134
00BDORdrArmorUBCloak
00BDORdrArmorUBHair
00BDORdrArmorUBHair002
```

It shows a list of `*.xml` files and which are the possible bodies and armors fould in such file.

Let's start with the easiest.

#### Easiest example

```
x:\bla bla bla...\meshes\Evil Lady\evldy.xml
collisionBody
EL_Hands_Cloth
```

Here the body is quite obvious and we could report it right away, but let's go through all steps anyway:

1. Find the associated armor.
2. Open it in [Nifskope][][^nfcDownload].
3. Find the body/bodies.
4. Report it/them.
5. (optional) Add your findings to `Physics_Bodies.txt` (or wait for me to update the program).

[^nfcDownload]: At the end of each post you'll find a section named **Assets**. Click on 
`NifSkope_blablabla.7z` on the most recent post to download it.

[Nifskope]: https://github.com/niftools/nifskope/releases

##### Find the associated armor

`x:\bla bla bla...\meshes\Evil Lady\evldy.xml` tell me where the armor is, so let's open its folder.

![](help_files/evldy0010.png)

Cool! A hard one to find :satisfied:!

!!!warning Xml files and and armor names
    Most of the time, armor creators name their `*.xml` files using the same name for both the `*.nif` (armor) and the `*.xml` file, but they are not required to.

... as in this case.
So let's find out which armor is the one we want.

##### Open it in Nifskope

`EL_HandsSMP_0.nif` seems suspicious, so let's open it[^bodyslide].

[^bodyslide]: For our purposes, it doesn't matter opening the `_0.nif` or the `_1.nif` files, since both contain the same stuff.
If you don't know what they're for and you are curious, those are (usually) generated by Bodyslide and `0` represents how a character will look at weight 0 while in game and `1` is weight 100.

##### Find the body/bodies

![](help_files/evldy0020.png)

And there it is!
As far as I've seen, physics bodies always look white when opened on Nifskope, so I click on it just to make sure it's the thing I want.

![](help_files/evldy0030.png)

As you can see, some names expanded at the left panel and the selected one has the name we wanted.

Remember what SMP Optimizer told you?

```
x:\bla bla bla...\meshes\Evil Lady\evldy.xml
collisionBody
EL_Hands_Cloth
```
As you can see, just above `collision body` in the left panel, there it is `EL_Hands_Cloth`. Click on that to see what happens.

##### Report it/them

Since we confirmed in Nifskope that `collisionBody` (as reported by SMP Optimizer) is a... duh... body, you can leave in SMP Optimizer Nexus page a comment telling me to add `collisionBody`.

!!!warning 
    You should report **the name reported by SMP Optimizer**, not the one found in Nifskope.

That's important to always remember, because in this case those names differ a little. The useful one is named `collisionBody`, while the one in Nifskope is named `collision body`.

If you tell me the one you found in Nifskope, the program won't work as expected.

##### (optional) Add your findings to `Physics_Bodies.txt`

This step is optional, but you can do it anyway so you can correctly optimize your files right away.

Inside the folder where SMP Optimizer is located, you'll find a file named `Physics_Bodies.txt`.

![](help_files/evldy0040.png)

Open it and add the newly found body to it.

![](help_files/evldy0050.png)

That's it!

Next time you run SMP Optimizer, all files containing a body named `collisionBody` will be processed as expected!

#### Easy example

```
x:\bla bla bla...\meshes\Princess\Skirt.xml
CollisionBody
Boots
SkirtA_1_1
```

I won't go all over this because is obvious right away which of those is the body.

![](help_files/princessSkirt0010.png)

!!!warning
    At the time of writing, **names are case sensitive**. Meaning `collisionBody` is different than `CollisionBody`, so you need to add any words that only differ in case.

    I'm still pondering if I should keep it like that or if I should make it case insensitive.

    Don't worry, though.
    If I ever change that it will be transparent to you as an user and you should not worry too much about it.

#### Not so easy example

```
x:\bla bla bla...\meshes\Dragon Lilly\skirt.xml
boxlow
skirt
```

If you know what to search for, both examples above are so easy too figure out you don't even need to open Nifskope to see which is the body and which are the armors, but some authors use really names that may be completely out of what you would expect, like `boxlow` here:

![](help_files/dragonlilly0010.png)

![](help_files/dragonlilly0020.png)

Here, `boxlow` and `skirt` are inside the `cuiras.nif` file and as you can see, the physics body is `boxlow`.

There's also a typical body in there, named `BaseShape`, but we are not interested in that because is not an SMP body.

![](help_files/dragonlilly0030.png)

By the way, notice how some of my textures are pink.
That happens when textures are not found. 

In my case, this happens because I'm opening my files by double clicking them with the Windows explorer (I told Windows to open nif files with Nifskope), but I use MO2 as mod manager.

If I double click my file inside MO2 using [NIF Preview][] if get the expected result.

![](help_files/dragonlilly0040.png)

Notice how the physics body still looks white.

In fact, a situation like this is the one this is the one that inspired the analyze functionanlity for this program.

When optimizing [Chun Li Qipao][] I noticed collision were always terrible and I found its physics bodies (yes: it has two) have weird names.

This is what SMP Optimizer would have reported:

```
x:\bla bla bla...\meshes\Coco_Cloths\CHUNLI_v1\coco_chunli.xml
boxs
boxbell
coco_WGT_up
coco_wgt_mid
```
And this is Nifskope:

![](help_files/chun0010.png)

![](help_files/chun0020.png)

#### Hard example

```
x:\bla bla bla...\meshes\BDO Darkborne Rose\BDORdrArmor.xml
VCBBE
00BDORdrArmorUB
00BDORdrArmorDecShoHDT
00BDORdrArmorDecShoHDT001
Scene Root:134
00BDORdrArmorUBCloak
00BDORdrArmorUBHair
00BDORdrArmorUBHair002
```

I'm quite sure `VCBBE` is the physics body, but `Scene Root:134` sticks like a sore thumb, so let's what it is so we can make sure we report (or add) the correct body.

![](help_files/darkbone0010.png)

Meh! Turns out it was only a piece of the armor.

Most of the time you find things that look intimidating, you will find they are actually quite straight-forward and easy to understand once you know what you are looking for (<span class="important">all the white bodies!</span>).

![](help_files/darkbone0020.png)

### Analyzing and you

I expect you to use this mode quite sparingly, since I added tons of physics bodies before release; those few you saw in the examples were there because I made the examples while I was working in this program.

At release time, there should be way more of then in there, so you don't have to worry that much, but you know what to do in case SMP Optimizer complains to you :slightly_smiling_face:.

[NIF Preview]: https://www.nexusmods.com/skyrimspecialedition/mods/69813
[Chun Li Qipao]: https://www.daymarrworkshop.com/post/gift-chun-li-qipao-cbbe-uunp-se